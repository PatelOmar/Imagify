{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _regeneratorRuntime from\"/Users/omarp/workspace/Shopify_Image_Repo_Challenge/Imagify/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/omarp/workspace/Shopify_Image_Repo_Challenge/Imagify/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/omarp/workspace/Shopify_Image_Repo_Challenge/Imagify/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useRef}from\"react\";import Button from'react-bootstrap/Button';import{useHistory}from\"react-router-dom\";import*as FirestoreService from'../firebase/firestore';import Form from'react-bootstrap/Form';import imageCompression from'browser-image-compression';export default function SignedIn(){var history=useHistory();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),images=_useState2[0],setImages=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),compressedImages=_useState4[0],setCompressedImages=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),click=_useState6[0],setClick=_useState6[1];var fileInput=useRef(null);var handleChange=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var options,tempCompressedImages,tempImages,files,i,compressedFile;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setClick(!click);options={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:true};console.log(\"Started!\");tempCompressedImages=[];tempImages=[];files=e.target.files;i=0;case 7:if(!(i<files.length)){_context.next=23;break;}if(!e.target.files[i]){_context.next=20;break;}_context.prev=9;_context.next=12;return imageCompression(e.target.files[i],options);case 12:compressedFile=_context.sent;tempCompressedImages.push(compressedFile);tempImages.push(e.target.files[i]);_context.next=20;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](9);console.log(_context.t0);case 20:i++;_context.next=7;break;case 23:try{setCompressedImages(tempCompressedImages);setImages(tempImages);}catch(error){console.log(error);}console.log(\"Files ready for upload!\");setClick(!click);// if(e.target.files[0]){\n//     try {\n//         console.log(\"Started\");\n//         const compressedFile = await imageCompression(e.target.files[0], options);\n//         console.log(\"worked\");\n//         setCompressedImage(compressedFile);\n//         setImage(e.target.files[0]);\n//         // await uploadToServer(compressedFile); // write your own logic\n//       } catch (error) {\n//         console.log(error);\n//       }\n// }\ncase 26:case\"end\":return _context.stop();}}},_callee,null,[[9,17]]);}));return function handleChange(_x){return _ref.apply(this,arguments);};}();var handleUpload=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var _loop,i;return _regeneratorRuntime.wrap(function _callee3$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:// console.log(image);\n// console.log(compressedImage);\nsetClick(!click);_loop=/*#__PURE__*/_regeneratorRuntime.mark(function _loop(i){var uploadTask;return _regeneratorRuntime.wrap(function _loop$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return FirestoreService.storage.ref(\"images/\".concat(compressedImages[i].name)).put(compressedImages[i]);case 2:uploadTask=_context3.sent;console.log(\"Uploaded\");uploadTask.task.on(\"state_changed\",function(snapshot){},function(error){console.log(error);},function(){FirestoreService.storage.ref(\"images\").child(compressedImages[i].name).getDownloadURL().then(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(url){var uploaded;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return FirestoreService.uploadImage(url);case 2:uploaded=_context2.sent;console.log(\"Uploaded: \"+uploaded);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref3.apply(this,arguments);};}());});case 5:case\"end\":return _context3.stop();}}},_loop);});i=0;case 3:if(!(i<compressedImages.length)){_context4.next=8;break;}return _context4.delegateYield(_loop(i),\"t0\",5);case 5:i++;_context4.next=3;break;case 8:console.log(\"Uploaded!\");setCompressedImages([]);setImages([]);setClick(!click);case 12:case\"end\":return _context4.stop();}}},_callee3);}));return function handleUpload(){return _ref2.apply(this,arguments);};}();function handleClick(){fileInput.current.click();}return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"Page-home-buttons\",children:[/*#__PURE__*/_jsx(\"input\",{style:{display:\"none\"},type:\"file\",onChange:handleChange,ref:fileInput}),/*#__PURE__*/_jsx(Button,{onClick:handleClick,variant:\"outline-info\",size:\"lg\",children:\"Add Files\"}),/*#__PURE__*/_jsx(\"span\",{className:\"Spacer\"}),/*#__PURE__*/_jsx(Button,{variant:\"outline-info\",size:\"lg\",disabled:false,onClick:handleUpload,children:\"Upload\"})]})});}","map":{"version":3,"sources":["/Users/omarp/workspace/Shopify_Image_Repo_Challenge/Imagify/src/components/SignedIn.js"],"names":["React","useState","useRef","Button","useHistory","FirestoreService","Form","imageCompression","SignedIn","history","images","setImages","compressedImages","setCompressedImages","click","setClick","fileInput","handleChange","e","options","maxSizeMB","maxWidthOrHeight","useWebWorker","console","log","tempCompressedImages","tempImages","files","target","i","length","compressedFile","push","error","handleUpload","storage","ref","name","put","uploadTask","task","on","snapshot","child","getDownloadURL","then","url","uploadImage","uploaded","handleClick","current","display"],"mappings":"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","sourcesContent":["import React, { useState, useRef } from \"react\";\nimport Button from 'react-bootstrap/Button'\nimport { useHistory } from \"react-router-dom\";\nimport * as FirestoreService from '../firebase/firestore';\nimport Form from 'react-bootstrap/Form';\nimport imageCompression from 'browser-image-compression';\n\nexport default function SignedIn() {\n    let history = useHistory();\n    const [images,setImages] = useState([]);\n    const [compressedImages,setCompressedImages] = useState([]);\n    const [click,setClick] = useState(false);\n    const fileInput = useRef(null);\n\n    const handleChange = async(e) =>{\n        setClick(!click);\n        const options = {\n            maxSizeMB: 1,\n            maxWidthOrHeight: 1920,\n            useWebWorker: true\n        }\n        console.log(\"Started!\");\n        let tempCompressedImages = [];\n        let tempImages = [];\n        const files = e.target.files;\n        for (let i = 0; i < files.length; i++){\n            if(e.target.files[i]){\n                try {\n                    const compressedFile = await imageCompression(e.target.files[i], options);\n                    tempCompressedImages.push(compressedFile);\n                    tempImages.push(e.target.files[i]);\n                    } catch (error) {\n                    console.log(error);\n                    }\n            }\n        }\n        try{\n            setCompressedImages(tempCompressedImages);\n            setImages(tempImages);\n        }   catch (error) {\n            console.log(error);\n        }\n        console.log(\"Files ready for upload!\");\n        setClick(!click);\n        // if(e.target.files[0]){\n        //     try {\n        //         console.log(\"Started\");\n        //         const compressedFile = await imageCompression(e.target.files[0], options);\n        //         console.log(\"worked\");\n        //         setCompressedImage(compressedFile);\n        //         setImage(e.target.files[0]);\n        //         // await uploadToServer(compressedFile); // write your own logic\n        //       } catch (error) {\n        //         console.log(error);\n        //       }\n        // }\n        \n    }\n    const handleUpload = async() =>{\n        // console.log(image);\n        // console.log(compressedImage);\n        setClick(!click);\n        for (let i = 0; i < compressedImages.length; i++){\n            const uploadTask = await FirestoreService.storage.ref(`images/${compressedImages[i].name}`).put(compressedImages[i]);\n            console.log(\"Uploaded\");\n            uploadTask.task.on(\"state_changed\", \n                            snapshot => {}, \n                            error =>{\n                                console.log(error);\n                            },\n                            () =>  {\n                                FirestoreService.storage.ref(\"images\").child(compressedImages[i].name).getDownloadURL().then(async (url) => {\n                                    // console.log(url);\n                                    \n                                    let uploaded = await FirestoreService.uploadImage(url);\n                                    console.log(\"Uploaded: \"+uploaded);\n                                });\n                            });\n        }  \n        console.log(\"Uploaded!\");\n        setCompressedImages([]);\n        setImages([]);  \n        setClick(!click);       \n    }\n    function handleClick() {\n        fileInput.current.click();\n      }\n    return (\n        <div>\n            <div className=\"Page-home-buttons\">\n                <input style= {{display: \"none\"}} type=\"file\" onChange={handleChange} ref={fileInput}/>\n                <Button onClick={handleClick} variant=\"outline-info\"  size=\"lg\">Add Files</Button> \n                <span className=\"Spacer\"/>\n                <Button variant=\"outline-info\"  size=\"lg\" disabled={false} onClick={handleUpload}>Upload</Button> \n            </div> \n        </div> \n    )\n}"]},"metadata":{},"sourceType":"module"}